## 工作任务表



### 2.9 周三

1. 初始化admin后台服务，熟悉接入sequelize ORM框架，连接并操作mysql数据库



### 2.10周四

1. 管理系统前端与后台联调对接
2. 登录注册账号（简单实现）

#### 问题

1. 学习sequelize，是使用schema、modules、controllers的方式还是sequelize和Model

   1. 上层至下层：routes > controllers > modules(model)>schema

2. https://github.com/sdchuang/koa2-sequelize  初始框架项目





### 2.11周五

1. 完善登录注册账号，session等 tokon
2. 指定code：0成功 1失败
3. 数据库
   1. 完善用户表信息 username password role email phone avatar 
   2. 根据username获取用户信息
   3. 后面添加uuid



#### 问题

1. 将变量写在全局里面

2. 确定用户表

   username password role

3. 是否需要实现自动登录？
4. 名字和uuid不能重复





### 2.28周一

1. 迁移本地数据库到rds，并连接后端成功【完成】
   1. 创建数据库实例，申请公网地址，本地连接，复制表并保存推送，后端项目连接，测试表格功能
2. 寻找前台项目并跑通，找不到跑不通，自己搭建，可以参考商城项目
3. 完成ems后台管理以及token校验
   1. 前端token暂时先存在本地



### 3.2周二

1. 挣扎一下，找一个展示中心的前端项目
   1. ~~找到任意首页进行修改~~
      1. ~~简书首页https://github.com/xuzhengkang0408/jianshu~~
      2. ~~掘金首页https://github.com/czqn8/react-juejin~~
   2. 掘金，初始化自己的项目

1. 创建前台项目，与后台项目共享登录状态，添加一个字段用于判断前后台


**小结：**全部自己搭建，其他项目仅作参考



### 3.3周三

1. 用户设置，怎么修改数据库
   1. `useRequest`hook数据的使用只能在react组件内部
2. 数据库上传保存图片
   1. 图片可以转化为base64
   
3. 将服务器设置为本地资源服务器



### 3.4周四

1. 修复前端版本兼容问题



### 3.5周五

1. 搭建前台前端项目，后台区分登录来源

   1. 区分来源

      1. 大多数是不需要token的，与管理共享token。后台区分请求地址区分

         设置/fd开头的所有路由不需要检查路由

   2. 优化后台代码框架，整理代码




### 3.5周六

1. ems前端口令无效时跳转登录页 1
2. 优化后台代码框架，整理代码 1
3. 创建整理前台项目 1
   1. `/fontEnd/user/currentUser`没有携带token的时候默认未登录账号
   2. 隐藏侧边栏和菜单栏



### 3.6周日

1. 写好日期组件，前端先模拟一个数据
   1. 直接访问链接的时候默认是下载模式
2. 完成header最上面的部，中间第一栏内容



### 3.7 周一

1. 尝试读取服务器文件
2. 实现上传文件并预览功能，前端可编辑word文档



### 3.8周二

1. 完成更新头像功能，解决更新数据库bug
   1. 返回的连接会自动链接本地请求的地址，需要在返回的地址中拼接`http://`，不然就会链接当前路由的地址

2. 预览文件
   1. 文件可编辑 （未完成）

3. 添加**系统管理**：添加资源数据表
   1. 采购公告
   2. 结果公示

公示：

notice

goods_and_services



### 3.10周四

1. 完成征询意见的后端建表（增删改查）
   1. 创建、获取全部列表、删除、根据id获取对应行
2. 前端建表增删改查（尽量使用高级table）



问题：

1. 怎么在schema中生命数组（对象）=》全转为字符串
2. 暂时前端判断不为空，后端只在数据表中判断，有空之后才在controller中进行限制





### 3.11周五

1. 完成征询意见前端、尽力完成采购管理和结果管理
2. 初稿文档完成1/3



### 3.12周六

1. 完成征询意见新建表单



### 3.13周日

1. 完成征询意见更新表单以及删除功能、批量删除
2. 抽屉详情展示
3. 优化代码，同理完成采购公告



### 3.14周一

1. 设计用户表、后台完成供应商表
2. 优化征询意见代码
3. 设计、完成基本用户信息前后端ems

采购公告需要通过专家审批

征询意见、采购公告、结果公告、更正公告是一致的



### 3.15周二

1. 完成供应商管理前后端
2. 



### 3.16周三

1. 调研：全国统一代码api
2. ems前端：用户管理



### 3.17周四

1. ems前端系统管理页面，提取公共组件

2. 优化fd后端登录

   



### 3.18周五

1. fd 完成登录注册，缕清整个框架【几乎没做】
2. 优化系统管理更新节点和新建节点、添加关联公告 【几乎没做】





### 3.19周六

1. fd 完成登录注册，缕清整个框架
2. 优化系统管理更新节点和新建节点、添加关联公告 

资源展示超过8条的时候，查看更多



### 3.20周日

1. 完善导航栏，供应商注册
2. 抽离前端组件共同



### 3.21周一

陷入组件重建于不重建的死循环

- 如果通过跳转路由的方式，组件每次都会重建，就无法保存组件的状态
- 通过组件内定义状态，就无法在路由变化时更新组件状态

为文件阅读器，添加一个伪装文件





### 3.22周二

1. 基本完成导航与路由跳转以及内容
2. 添加搜索功能，以及搜索列表展示
3. 链接跳转的详情页信息页
   1. 详情页内容title



后端ems：注意一下资源几个接口的数据返回情况 consultationListRes?.data 还是 consultationListRes?.data?.data

详情列表页面卡住了。



- ~~公告详情页面~~

~~跳转公告详情页面 携带参数 /resourceDetail?current=1&id=1    进入页面之后再查询对应的信息~~

之后页面做完之后，所有的文件都要通过ems进行上传





### 3.23周三

1. 公告详情页需要返回一个资源url 或者 前端拼接
2. 公告列表页面，返回首页的时候恢复公告选项的状态
   1. 方案一：传一个query
   2. 方案二：添加一个返回按钮手动改变state 
3. 公告列表后续优化，state不同时渲染不同的页面
4. 分页暂时未完成
5. 回到首页的时候恢复详情卡片的状态
   1. 添加返回按钮 √

6. 日历只有招标的日子才可以点击

#### 总结

1. 改变state的时候不能放在useEffect里面



### 3.24周四~3.31周四 毕业论文



### 4.13后台管理

后面的所有需求，表面功夫要做足，不用管实际实现

1. 替换七牛云oss地址（前后台）
   1. 后台1
   2. 前台1
2. 公告资源详情 1 
3. 完成前台展示，获取资源相关接口，以及详情 1
4. 招投标管理
   1. 投标管理
   2. 成交结果



##### bug

- 未登录用户无法获得详情
- 分页的总是只是暂时的
- 下载中心的路由错误
- 列表详情高度设置



### 4.14前台

- 招投标管理
  - 投标管理
  - 成交结果

1. 优化及bug

- 下载中心添加下载按钮1



### 4.16前台

###### 投标

接口：http://localhost:3000/api/tender/createTender

传参：

```json
采购公告ID announcementId 1 // 必传
采购公告名称 announcementName 1// 必传
供应商编号 supplierUsername 1// 必传
供应商名称 supplierName 1// 必传
附件 file // 暂不支持附件
金额 amount // 必传
```

完成合同管理和发票管理

1. 生成结果
   1. 判断采购公告状态是否结算，status为4已结算，

2. 更新数据库数据
   1. 更正公告...



3. 前台投标
   1. 后端路由：注意添加前端表示路由
      1. 不能重复投递 announcementId 和 supplierUsername返回数据为空



### 4.18前台

1. 关注公告
   1. 判断是否关注
   2. 关注公告接口
      1. 关注
      2. 取消关注



### 4.21前台

1. 招标倒计时、我的投标添加状态
   1. 后台创建时要规定结束时间必须晚于开始时间



